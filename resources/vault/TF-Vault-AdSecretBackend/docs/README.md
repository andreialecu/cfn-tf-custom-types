# TF::Vault::AdSecretBackend

Creates an Active Directory Secret Backend for Vault. Active Directory secret backend
rotates existing Active Directory service account passwords based on the TTL of the role.

~> **Important** All data provided in the resource configuration will be
written in cleartext to state and plan files generated by Terraform, and
will appear in the console output when Terraform runs. Protect these
artifacts accordingly. See
[the main provider documentation](../index.html)
for more details.

## Syntax

To declare this entity in your AWS CloudFormation template, use the following syntax:

### JSON

<pre>
{
    "Type" : "TF::Vault::AdSecretBackend",
    "Properties" : {
        "<a href="#anonymousgroupsearch" title="AnonymousGroupSearch">AnonymousGroupSearch</a>" : <i>Boolean</i>,
        "<a href="#backend" title="Backend">Backend</a>" : <i>String</i>,
        "<a href="#binddn" title="Binddn">Binddn</a>" : <i>String</i>,
        "<a href="#bindpass" title="Bindpass">Bindpass</a>" : <i>String</i>,
        "<a href="#casesensitivenames" title="CaseSensitiveNames">CaseSensitiveNames</a>" : <i>Boolean</i>,
        "<a href="#certificate" title="Certificate">Certificate</a>" : <i>String</i>,
        "<a href="#clienttlscert" title="ClientTlsCert">ClientTlsCert</a>" : <i>String</i>,
        "<a href="#clienttlskey" title="ClientTlsKey">ClientTlsKey</a>" : <i>String</i>,
        "<a href="#defaultleasettlseconds" title="DefaultLeaseTtlSeconds">DefaultLeaseTtlSeconds</a>" : <i>Double</i>,
        "<a href="#denynullbind" title="DenyNullBind">DenyNullBind</a>" : <i>Boolean</i>,
        "<a href="#description" title="Description">Description</a>" : <i>String</i>,
        "<a href="#discoverdn" title="Discoverdn">Discoverdn</a>" : <i>Boolean</i>,
        "<a href="#formatter" title="Formatter">Formatter</a>" : <i>String</i>,
        "<a href="#groupattr" title="Groupattr">Groupattr</a>" : <i>String</i>,
        "<a href="#groupdn" title="Groupdn">Groupdn</a>" : <i>String</i>,
        "<a href="#groupfilter" title="Groupfilter">Groupfilter</a>" : <i>String</i>,
        "<a href="#insecuretls" title="InsecureTls">InsecureTls</a>" : <i>Boolean</i>,
        "<a href="#lastrotationtolerance" title="LastRotationTolerance">LastRotationTolerance</a>" : <i>Double</i>,
        "<a href="#length" title="Length">Length</a>" : <i>Double</i>,
        "<a href="#local" title="Local">Local</a>" : <i>Boolean</i>,
        "<a href="#maxleasettlseconds" title="MaxLeaseTtlSeconds">MaxLeaseTtlSeconds</a>" : <i>Double</i>,
        "<a href="#maxttl" title="MaxTtl">MaxTtl</a>" : <i>Double</i>,
        "<a href="#passwordpolicy" title="PasswordPolicy">PasswordPolicy</a>" : <i>String</i>,
        "<a href="#requesttimeout" title="RequestTimeout">RequestTimeout</a>" : <i>Double</i>,
        "<a href="#starttls" title="Starttls">Starttls</a>" : <i>Boolean</i>,
        "<a href="#tlsmaxversion" title="TlsMaxVersion">TlsMaxVersion</a>" : <i>String</i>,
        "<a href="#tlsminversion" title="TlsMinVersion">TlsMinVersion</a>" : <i>String</i>,
        "<a href="#ttl" title="Ttl">Ttl</a>" : <i>Double</i>,
        "<a href="#upndomain" title="Upndomain">Upndomain</a>" : <i>String</i>,
        "<a href="#url" title="Url">Url</a>" : <i>String</i>,
        "<a href="#usepre111groupcnbehavior" title="UsePre111GroupCnBehavior">UsePre111GroupCnBehavior</a>" : <i>Boolean</i>,
        "<a href="#usetokengroups" title="UseTokenGroups">UseTokenGroups</a>" : <i>Boolean</i>,
        "<a href="#userattr" title="Userattr">Userattr</a>" : <i>String</i>,
        "<a href="#userdn" title="Userdn">Userdn</a>" : <i>String</i>
    }
}
</pre>

### YAML

<pre>
Type: TF::Vault::AdSecretBackend
Properties:
    <a href="#anonymousgroupsearch" title="AnonymousGroupSearch">AnonymousGroupSearch</a>: <i>Boolean</i>
    <a href="#backend" title="Backend">Backend</a>: <i>String</i>
    <a href="#binddn" title="Binddn">Binddn</a>: <i>String</i>
    <a href="#bindpass" title="Bindpass">Bindpass</a>: <i>String</i>
    <a href="#casesensitivenames" title="CaseSensitiveNames">CaseSensitiveNames</a>: <i>Boolean</i>
    <a href="#certificate" title="Certificate">Certificate</a>: <i>String</i>
    <a href="#clienttlscert" title="ClientTlsCert">ClientTlsCert</a>: <i>String</i>
    <a href="#clienttlskey" title="ClientTlsKey">ClientTlsKey</a>: <i>String</i>
    <a href="#defaultleasettlseconds" title="DefaultLeaseTtlSeconds">DefaultLeaseTtlSeconds</a>: <i>Double</i>
    <a href="#denynullbind" title="DenyNullBind">DenyNullBind</a>: <i>Boolean</i>
    <a href="#description" title="Description">Description</a>: <i>String</i>
    <a href="#discoverdn" title="Discoverdn">Discoverdn</a>: <i>Boolean</i>
    <a href="#formatter" title="Formatter">Formatter</a>: <i>String</i>
    <a href="#groupattr" title="Groupattr">Groupattr</a>: <i>String</i>
    <a href="#groupdn" title="Groupdn">Groupdn</a>: <i>String</i>
    <a href="#groupfilter" title="Groupfilter">Groupfilter</a>: <i>String</i>
    <a href="#insecuretls" title="InsecureTls">InsecureTls</a>: <i>Boolean</i>
    <a href="#lastrotationtolerance" title="LastRotationTolerance">LastRotationTolerance</a>: <i>Double</i>
    <a href="#length" title="Length">Length</a>: <i>Double</i>
    <a href="#local" title="Local">Local</a>: <i>Boolean</i>
    <a href="#maxleasettlseconds" title="MaxLeaseTtlSeconds">MaxLeaseTtlSeconds</a>: <i>Double</i>
    <a href="#maxttl" title="MaxTtl">MaxTtl</a>: <i>Double</i>
    <a href="#passwordpolicy" title="PasswordPolicy">PasswordPolicy</a>: <i>String</i>
    <a href="#requesttimeout" title="RequestTimeout">RequestTimeout</a>: <i>Double</i>
    <a href="#starttls" title="Starttls">Starttls</a>: <i>Boolean</i>
    <a href="#tlsmaxversion" title="TlsMaxVersion">TlsMaxVersion</a>: <i>String</i>
    <a href="#tlsminversion" title="TlsMinVersion">TlsMinVersion</a>: <i>String</i>
    <a href="#ttl" title="Ttl">Ttl</a>: <i>Double</i>
    <a href="#upndomain" title="Upndomain">Upndomain</a>: <i>String</i>
    <a href="#url" title="Url">Url</a>: <i>String</i>
    <a href="#usepre111groupcnbehavior" title="UsePre111GroupCnBehavior">UsePre111GroupCnBehavior</a>: <i>Boolean</i>
    <a href="#usetokengroups" title="UseTokenGroups">UseTokenGroups</a>: <i>Boolean</i>
    <a href="#userattr" title="Userattr">Userattr</a>: <i>String</i>
    <a href="#userdn" title="Userdn">Userdn</a>: <i>String</i>
</pre>

## Properties

#### AnonymousGroupSearch

Use anonymous binds when performing LDAP group searches
(if true the initial credentials will still be used for the initial connection test).

_Required_: No

_Type_: Boolean

_Update requires_: [No interruption](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt)

#### Backend

The unique path this backend should be mounted at. Must
not begin or end with a `/`. Defaults to `ad`.

_Required_: No

_Type_: String

_Update requires_: [No interruption](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt)

#### Binddn

Distinguished name of object to bind when performing user and group search.

_Required_: Yes

_Type_: String

_Update requires_: [No interruption](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt)

#### Bindpass

Password to use along with binddn when performing user search.

_Required_: Yes

_Type_: String

_Update requires_: [No interruption](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt)

#### CaseSensitiveNames

If set, user and group names assigned to policies within the
backend will be case sensitive. Otherwise, names will be normalized to lower case.

_Required_: No

_Type_: Boolean

_Update requires_: [No interruption](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt)

#### Certificate

CA certificate to use when verifying LDAP server certificate, must be
x509 PEM encoded.

_Required_: No

_Type_: String

_Update requires_: [No interruption](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt)

#### ClientTlsCert

Client certificate to provide to the LDAP server, must be x509 PEM encoded.

_Required_: No

_Type_: String

_Update requires_: [No interruption](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt)

#### ClientTlsKey

Client certificate key to provide to the LDAP server, must be x509 PEM encoded.

_Required_: No

_Type_: String

_Update requires_: [No interruption](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt)

#### DefaultLeaseTtlSeconds

Default lease duration for secrets in seconds.

_Required_: No

_Type_: Double

_Update requires_: [No interruption](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt)

#### DenyNullBind

Denies an unauthenticated LDAP bind request if the user's password is empty;
defaults to true.

_Required_: No

_Type_: Boolean

_Update requires_: [No interruption](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt)

#### Description

Human-friendly description of the mount for the Active Directory backend.

_Required_: No

_Type_: String

_Update requires_: [No interruption](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt)

#### Discoverdn

Use anonymous bind to discover the bind Distinguished Name of a user.

_Required_: No

_Type_: Boolean

_Update requires_: [No interruption](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt)

#### Formatter

Text to insert the password into, ex. "customPrefix{{PASSWORD}}customSuffix". This
setting is deprecated and should instead use `password_policy`.

_Required_: No

_Type_: String

_Update requires_: [No interruption](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt)

#### Groupattr

LDAP attribute to follow on objects returned by <groupfilter> in order to enumerate
user group membership. Examples: `cn` or `memberOf`, etc. Defaults to `cn`.

_Required_: No

_Type_: String

_Update requires_: [No interruption](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt)

#### Groupdn

LDAP search base to use for group membership search (eg: ou=Groups,dc=example,dc=org).

_Required_: No

_Type_: String

_Update requires_: [No interruption](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt)

#### Groupfilter

Go template for querying group membership of user (optional) The template can access
the following context variables: UserDN, Username. Defaults to `(|(memberUid={{.Username}})(member={{.UserDN}})(uniqueMember={{.UserDN}}))`.

_Required_: No

_Type_: String

_Update requires_: [No interruption](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt)

#### InsecureTls

Skip LDAP server SSL Certificate verification. This is not recommended for production.
Defaults to `false`.

_Required_: No

_Type_: Boolean

_Update requires_: [No interruption](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt)

#### LastRotationTolerance

The number of seconds after a Vault rotation where, if Active Directory
shows a later rotation, it should be considered out-of-band.

_Required_: No

_Type_: Double

_Update requires_: [No interruption](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt)

#### Length

The desired length of passwords that Vault generates. This
setting is deprecated and should instead use `password_policy`.

_Required_: No

_Type_: Double

_Update requires_: [No interruption](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt)

#### Local

Mark the secrets engine as local-only. Local engines are not replicated or removed by
replication.Tolerance duration to use when checking the last rotation time.

_Required_: No

_Type_: Boolean

_Update requires_: [No interruption](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt)

#### MaxLeaseTtlSeconds

Maximum possible lease duration for secrets in seconds.

_Required_: No

_Type_: Double

_Update requires_: [No interruption](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt)

#### MaxTtl

In seconds, the maximum password time-to-live.

_Required_: No

_Type_: Double

_Update requires_: [No interruption](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt)

#### PasswordPolicy

Name of the password policy to use to generate passwords.

_Required_: No

_Type_: String

_Update requires_: [No interruption](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt)

#### RequestTimeout

Timeout, in seconds, for the connection when making requests against the server
before returning back an error.

_Required_: No

_Type_: Double

_Update requires_: [No interruption](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt)

#### Starttls

Issue a StartTLS command after establishing unencrypted connection.

_Required_: No

_Type_: Boolean

_Update requires_: [No interruption](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt)

#### TlsMaxVersion

Maximum TLS version to use. Accepted values are `tls10`, `tls11`,
`tls12` or `tls13`. Defaults to `tls12`.

_Required_: No

_Type_: String

_Update requires_: [No interruption](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt)

#### TlsMinVersion

Minimum TLS version to use. Accepted values are `tls10`, `tls11`,
`tls12` or `tls13`. Defaults to `tls12`.

_Required_: No

_Type_: String

_Update requires_: [No interruption](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt)

#### Ttl

In seconds, the default password time-to-live.

_Required_: No

_Type_: Double

_Update requires_: [No interruption](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt)

#### Upndomain

Enables userPrincipalDomain login with [username]@UPNDomain.

_Required_: No

_Type_: String

_Update requires_: [No interruption](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt)

#### Url

LDAP URL to connect to. Multiple URLs can be specified by concatenating
them with commas; they will be tried in-order. Defaults to `ldap://127.0.0.1`.

_Required_: No

_Type_: String

_Update requires_: [No interruption](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt)

#### UsePre111GroupCnBehavior

In Vault 1.1.1 a fix for handling group CN values of
different cases unfortunately introduced a regression that could cause previously defined groups
to not be found due to a change in the resulting name. If set true, the pre-1.1.1 behavior for
matching group CNs will be used. This is only needed in some upgrade scenarios for backwards
compatibility. It is enabled by default if the config is upgraded but disabled by default on
new configurations.

_Required_: No

_Type_: Boolean

_Update requires_: [No interruption](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt)

#### UseTokenGroups

If true, use the Active Directory tokenGroups constructed attribute of the
user to find the group memberships. This will find all security groups including nested ones.

_Required_: No

_Type_: Boolean

_Update requires_: [No interruption](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt)

#### Userattr

Attribute used when searching users. Defaults to `cn`.

_Required_: No

_Type_: String

_Update requires_: [No interruption](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt)

#### Userdn

LDAP domain to use for users (eg: ou=People,dc=example,dc=org)`.

_Required_: No

_Type_: String

_Update requires_: [No interruption](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt)

## Return Values

### Ref

When you pass the logical ID of this resource to the intrinsic `Ref` function, Ref returns the tfcfnid.

### Fn::GetAtt

The `Fn::GetAtt` intrinsic function returns a value for a specified attribute of this type. The following are the available attributes and sample return values.

For more information about using the `Fn::GetAtt` intrinsic function, see [Fn::GetAtt](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-getatt.html).

#### tfcfnid

Internal identifier for tracking resource changes. Do not use.

#### Id

Returns the <code>Id</code> value.

