{
    "typeName": "TF::FortiOS::SystemSdwan",
    "description": "Configure redundant internet connections using SD-WAN (formerly virtual WAN link). Applies to FortiOS Version `>= 6.4.2`.",
    "sourceUrl": "https://github.com/iann0036/cfn-tf-custom-types.git",
    "documentationUrl": "https://github.com/iann0036/cfn-tf-custom-types/blob/docs/resources/fortios/TF-FortiOS-SystemSdwan/docs/README.md",
    "definitions": {
        "DuplicationDefinition": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "Id": {
                    "type": "number",
                    "description": "Duplication rule ID (1 - 255)."
                },
                "PacketDeDuplication": {
                    "type": "string",
                    "description": "Enable/disable discarding of packets that have been duplicated. Valid values: `enable`, `disable`."
                },
                "PacketDuplication": {
                    "type": "string",
                    "description": "Configure packet duplication method. Valid values: `disable`, `force`, `on-demand`."
                },
                "Dstaddr": {
                    "type": "array",
                    "insertionOrder": true,
                    "items": {
                        "$ref": "#/definitions/DstaddrDefinition"
                    }
                },
                "Dstaddr6": {
                    "type": "array",
                    "insertionOrder": true,
                    "items": {
                        "$ref": "#/definitions/Dstaddr6Definition"
                    }
                },
                "Dstintf": {
                    "type": "array",
                    "insertionOrder": true,
                    "items": {
                        "$ref": "#/definitions/DstintfDefinition"
                    }
                },
                "Service": {
                    "type": "array",
                    "insertionOrder": true,
                    "items": {
                        "$ref": "#/definitions/ServiceDefinition"
                    }
                },
                "ServiceId": {
                    "type": "array",
                    "insertionOrder": true,
                    "items": {
                        "$ref": "#/definitions/ServiceIdDefinition"
                    }
                },
                "Srcaddr": {
                    "type": "array",
                    "insertionOrder": true,
                    "items": {
                        "$ref": "#/definitions/SrcaddrDefinition"
                    }
                },
                "Srcaddr6": {
                    "type": "array",
                    "insertionOrder": true,
                    "items": {
                        "$ref": "#/definitions/Srcaddr6Definition"
                    }
                },
                "Srcintf": {
                    "type": "array",
                    "insertionOrder": true,
                    "items": {
                        "$ref": "#/definitions/SrcintfDefinition"
                    }
                }
            },
            "required": []
        },
        "FailAlertInterfacesDefinition": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "Name": {
                    "type": "string",
                    "description": "Physical interface name."
                }
            },
            "required": []
        },
        "HealthCheckDefinition": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "AddrMode": {
                    "type": "string",
                    "description": "Address mode (IPv4 or IPv6). Valid values: `ipv4`, `ipv6`."
                },
                "Diffservcode": {
                    "type": "string",
                    "description": "Differentiated services code point (DSCP) in the IP header of the probe packet."
                },
                "DnsMatchIp": {
                    "type": "string",
                    "description": "Response IP expected from DNS server if the protocol is DNS."
                },
                "DnsRequestDomain": {
                    "type": "string",
                    "description": "Fully qualified domain name to resolve for the DNS probe."
                },
                "Failtime": {
                    "type": "number",
                    "description": "Number of failures before server is considered lost (1 - 3600, default = 5)."
                },
                "FtpFile": {
                    "type": "string",
                    "description": "Full path and file name on the FTP server to download for FTP health-check to probe."
                },
                "FtpMode": {
                    "type": "string",
                    "description": "FTP mode. Valid values: `passive`, `port`."
                },
                "HaPriority": {
                    "type": "number",
                    "description": "HA election priority (1 - 50)."
                },
                "HttpAgent": {
                    "type": "string",
                    "description": "String in the http-agent field in the HTTP header."
                },
                "HttpGet": {
                    "type": "string",
                    "description": "URL used to communicate with the server if the protocol if the protocol is HTTP."
                },
                "HttpMatch": {
                    "type": "string",
                    "description": "Response string expected from the server if the protocol is HTTP."
                },
                "Interval": {
                    "type": "number",
                    "description": "Status check interval in milliseconds, or the time between attempting to connect to the server (500 - 3600*1000 msec, default = 500)."
                },
                "Name": {
                    "type": "string",
                    "description": "Health check name."
                },
                "PacketSize": {
                    "type": "number",
                    "description": "Packet size of a twamp test session,."
                },
                "Password": {
                    "type": "string",
                    "description": "Twamp controller password in authentication mode."
                },
                "Port": {
                    "type": "number",
                    "description": "Port number used to communicate with the server over the selected protocol (0-65535, default = 0, auto select. http, twamp: 80, udp-echo, tcp-echo: 7, dns: 53, ftp: 21)."
                },
                "ProbeCount": {
                    "type": "number",
                    "description": "Number of most recent probes that should be used to calculate latency and jitter (5 - 30, default = 30)."
                },
                "ProbePackets": {
                    "type": "string",
                    "description": "Enable/disable transmission of probe packets. Valid values: `disable`, `enable`."
                },
                "ProbeTimeout": {
                    "type": "number",
                    "description": "Time to wait before a probe packet is considered lost (500 - 3600*1000 msec, default = 500)."
                },
                "Protocol": {
                    "type": "string",
                    "description": "Protocol used to determine if the FortiGate can communicate with the server. Valid values: `ping`, `tcp-echo`, `udp-echo`, `http`, `twamp`, `dns`, `tcp-connect`, `ftp`."
                },
                "QualityMeasuredMethod": {
                    "type": "string",
                    "description": "Method to measure the quality of tcp-connect. Valid values: `half-open`, `half-close`."
                },
                "Recoverytime": {
                    "type": "number",
                    "description": "Number of successful responses received before server is considered recovered (1 - 3600, default = 5)."
                },
                "SecurityMode": {
                    "type": "string",
                    "description": "Twamp controller security mode. Valid values: `none`, `authentication`."
                },
                "Server": {
                    "type": "string",
                    "description": "IP address or FQDN name of the server."
                },
                "SlaFailLogPeriod": {
                    "type": "number",
                    "description": "Time interval in seconds that SLA fail log messages will be generated (0 - 3600, default = 0)."
                },
                "SlaPassLogPeriod": {
                    "type": "number",
                    "description": "Time interval in seconds that SLA pass log messages will be generated (0 - 3600, default = 0)."
                },
                "SystemDns": {
                    "type": "string",
                    "description": "Enable/disable system DNS as the probe server. Valid values: `disable`, `enable`."
                },
                "ThresholdAlertJitter": {
                    "type": "number",
                    "description": "Alert threshold for jitter (ms, default = 0)."
                },
                "ThresholdAlertLatency": {
                    "type": "number",
                    "description": "Alert threshold for latency (ms, default = 0)."
                },
                "ThresholdAlertPacketloss": {
                    "type": "number",
                    "description": "Alert threshold for packet loss (percentage, default = 0)."
                },
                "ThresholdWarningJitter": {
                    "type": "number",
                    "description": "Warning threshold for jitter (ms, default = 0)."
                },
                "ThresholdWarningLatency": {
                    "type": "number",
                    "description": "Warning threshold for latency (ms, default = 0)."
                },
                "ThresholdWarningPacketloss": {
                    "type": "number",
                    "description": "Warning threshold for packet loss (percentage, default = 0)."
                },
                "UpdateCascadeInterface": {
                    "type": "string",
                    "description": "Enable/disable update cascade interface. Valid values: `enable`, `disable`."
                },
                "UpdateStaticRoute": {
                    "type": "string",
                    "description": "Enable/disable updating the static route. Valid values: `enable`, `disable`."
                },
                "User": {
                    "type": "string",
                    "description": "The user name to access probe server."
                },
                "Members": {
                    "type": "array",
                    "insertionOrder": true,
                    "items": {
                        "$ref": "#/definitions/MembersDefinition"
                    }
                },
                "Sla": {
                    "type": "array",
                    "insertionOrder": true,
                    "items": {
                        "$ref": "#/definitions/SlaDefinition"
                    }
                }
            },
            "required": []
        },
        "MembersDefinition": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "SeqNum": {
                    "type": "number",
                    "description": "Member sequence number."
                }
            },
            "required": []
        },
        "NeighborDefinition": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "HealthCheck": {
                    "type": "string",
                    "description": "SD-WAN health-check name."
                },
                "Ip": {
                    "type": "string",
                    "description": "IP/IPv6 address of neighbor."
                },
                "Member": {
                    "type": "number",
                    "description": "Member sequence number."
                },
                "Role": {
                    "type": "string",
                    "description": "Role of neighbor. Valid values: `standalone`, `primary`, `secondary`."
                },
                "SlaId": {
                    "type": "number",
                    "description": "SLA ID."
                }
            },
            "required": []
        },
        "ServiceDefinition": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "Name": {
                    "type": "string",
                    "description": "Service and service group name."
                }
            },
            "required": []
        },
        "ZoneDefinition": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "Name": {
                    "type": "string",
                    "description": "Zone name."
                },
                "ServiceSlaTieBreak": {
                    "type": "string",
                    "description": "Method of selecting member if more than one meets the SLA. Valid values: `cfg-order`, `fib-best-match`."
                }
            },
            "required": []
        },
        "DstaddrDefinition": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "Name": {
                    "type": "string",
                    "description": "Address or address group name."
                }
            },
            "required": []
        },
        "Dstaddr6Definition": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "Name": {
                    "type": "string",
                    "description": "Address6 or address6 group name."
                }
            },
            "required": []
        },
        "DstintfDefinition": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "Name": {
                    "type": "string",
                    "description": "Interface, zone or SDWAN zone name."
                }
            },
            "required": []
        },
        "ServiceIdDefinition": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "Id": {
                    "type": "number",
                    "description": "SD-WAN service rule ID."
                }
            },
            "required": []
        },
        "SrcaddrDefinition": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "Name": {
                    "type": "string",
                    "description": "Address or address group name."
                }
            },
            "required": []
        },
        "Srcaddr6Definition": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "Name": {
                    "type": "string",
                    "description": "Address6 or address6 group name."
                }
            },
            "required": []
        },
        "SrcintfDefinition": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "Name": {
                    "type": "string",
                    "description": "Interface, zone or SDWAN zone name."
                }
            },
            "required": []
        },
        "SlaDefinition": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "Id": {
                    "type": "number",
                    "description": "SLA ID."
                },
                "JitterThreshold": {
                    "type": "number",
                    "description": "Jitter for SLA to make decision in milliseconds. (0 - 10000000, default = 5)."
                },
                "LatencyThreshold": {
                    "type": "number",
                    "description": "Latency for SLA to make decision in milliseconds. (0 - 10000000, default = 5)."
                },
                "LinkCostFactor": {
                    "type": "string",
                    "description": "Criteria on which to base link selection. Valid values: `latency`, `jitter`, `packet-loss`."
                },
                "PacketlossThreshold": {
                    "type": "number",
                    "description": "Packet loss for SLA to make decision in percentage. (0 - 100, default = 0)."
                }
            },
            "required": []
        }
    },
    "properties": {
        "tfcfnid": {
            "description": "Internal identifier for tracking resource changes. Do not use.",
            "type": "string"
        },
        "DuplicationMaxNum": {
            "type": "number",
            "description": "Maximum number of interface members a packet is duplicated in the SD-WAN zone (2 - 4, default = 2; if set to 3, the original packet plus 2 more copies are created)."
        },
        "DynamicSortSubtable": {
            "type": "string",
            "description": "true or false, set this parameter to true when using dynamic for_each + toset to configure and sort sub-tables, please do not set this parameter when configuring static sub-tables."
        },
        "FailDetect": {
            "type": "string",
            "description": "Enable/disable SD-WAN Internet connection status checking (failure detection). Valid values: `enable`, `disable`."
        },
        "Id": {
            "type": "string"
        },
        "LoadBalanceMode": {
            "type": "string",
            "description": "Algorithm or mode to use for load balancing Internet traffic to SD-WAN members. Valid values: `source-ip-based`, `weight-based`, `usage-based`, `source-dest-ip-based`, `measured-volume-based`."
        },
        "NeighborHoldBootTime": {
            "type": "number",
            "description": "Waiting period in seconds when switching from the primary neighbor to the secondary neighbor from the neighbor start. (0 - 10000000, default = 0)."
        },
        "NeighborHoldDown": {
            "type": "string",
            "description": "Enable/disable hold switching from the secondary neighbor to the primary neighbor. Valid values: `enable`, `disable`."
        },
        "NeighborHoldDownTime": {
            "type": "number",
            "description": "Waiting period in seconds when switching from the secondary neighbor to the primary neighbor when hold-down is disabled. (0 - 10000000, default = 0)."
        },
        "Status": {
            "type": "string",
            "description": "Enable/disable SD-WAN. Valid values: `disable`, `enable`."
        },
        "Vdomparam": {
            "type": "string",
            "description": "Specifies the vdom to which the resource will be applied when the FortiGate unit is running in VDOM mode. Only one vdom can be specified. If you want to inherit the vdom configuration of the provider, please do not set this parameter."
        },
        "Duplication": {
            "type": "array",
            "insertionOrder": false,
            "items": {
                "$ref": "#/definitions/DuplicationDefinition"
            }
        },
        "FailAlertInterfaces": {
            "type": "array",
            "insertionOrder": false,
            "items": {
                "$ref": "#/definitions/FailAlertInterfacesDefinition"
            }
        },
        "HealthCheck": {
            "type": "array",
            "insertionOrder": false,
            "items": {
                "$ref": "#/definitions/HealthCheckDefinition"
            }
        },
        "Members": {
            "type": "array",
            "insertionOrder": false,
            "items": {
                "$ref": "#/definitions/MembersDefinition"
            }
        },
        "Neighbor": {
            "type": "array",
            "insertionOrder": false,
            "items": {
                "$ref": "#/definitions/NeighborDefinition"
            }
        },
        "Service": {
            "type": "array",
            "insertionOrder": false,
            "items": {
                "$ref": "#/definitions/ServiceDefinition"
            }
        },
        "Zone": {
            "type": "array",
            "insertionOrder": false,
            "items": {
                "$ref": "#/definitions/ZoneDefinition"
            }
        }
    },
    "additionalProperties": false,
    "required": [],
    "readOnlyProperties": [
        "/properties/tfcfnid",
        "/properties/Id"
    ],
    "primaryIdentifier": [
        "/properties/tfcfnid"
    ],
    "handlers": {
        "create": {
            "permissions": [
                "s3:GetObject",
                "s3:DeleteObject",
                "lambda:InvokeFunction"
            ]
        },
        "read": {
            "permissions": [
                "s3:GetObject"
            ]
        },
        "update": {
            "permissions": [
                "s3:GetObject",
                "s3:DeleteObject",
                "lambda:InvokeFunction"
            ]
        },
        "delete": {
            "permissions": [
                "s3:GetObject",
                "s3:DeleteObject",
                "lambda:InvokeFunction"
            ]
        },
        "list": {
            "permissions": [
                "s3:GetObject",
                "s3:ListBucket"
            ]
        }
    },
    "writeOnlyProperties": [
        "/definitions/HealthCheckDefinition/Password"
    ]
}