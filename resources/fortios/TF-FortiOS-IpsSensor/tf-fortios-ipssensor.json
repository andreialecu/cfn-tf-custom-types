{
    "typeName": "TF::FortiOS::IpsSensor",
    "description": "Configure IPS sensor.",
    "sourceUrl": "https://github.com/iann0036/cfn-tf-custom-types.git",
    "documentationUrl": "https://github.com/iann0036/cfn-tf-custom-types/blob/docs/resources/fortios/TF-FortiOS-IpsSensor/docs/README.md",
    "definitions": {
        "EntriesDefinition": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "Action": {
                    "type": "string",
                    "description": "Action taken with traffic in which signatures are detected. Valid values: `pass`, `block`, `reset`, `default`."
                },
                "Application": {
                    "type": "string",
                    "description": "Applications to be protected. set application ? lists available applications. all includes all applications. other includes all unlisted applications."
                },
                "Id": {
                    "type": "number",
                    "description": "Rule ID in IPS database (0 - 4294967295)."
                },
                "Location": {
                    "type": "string",
                    "description": "Protect client or server traffic."
                },
                "Log": {
                    "type": "string",
                    "description": "Enable/disable logging of signatures included in filter. Valid values: `disable`, `enable`."
                },
                "LogAttackContext": {
                    "type": "string",
                    "description": "Enable/disable logging of attack context: URL buffer, header buffer, body buffer, packet buffer. Valid values: `disable`, `enable`."
                },
                "LogPacket": {
                    "type": "string",
                    "description": "Enable/disable packet logging. Enable to save the packet that triggers the filter. You can download the packets in pcap format for diagnostic use. Valid values: `disable`, `enable`."
                },
                "Os": {
                    "type": "string",
                    "description": "Operating systems to be protected.  all includes all operating systems. other includes all unlisted operating systems."
                },
                "Protocol": {
                    "type": "string",
                    "description": "Protocols to be examined. set protocol ? lists available protocols. all includes all protocols. other includes all unlisted protocols."
                },
                "Quarantine": {
                    "type": "string",
                    "description": "Quarantine method. Valid values: `none`, `attacker`."
                },
                "QuarantineExpiry": {
                    "type": "string",
                    "description": "Duration of quarantine. (Format ###d##h##m, minimum 1m, maximum 364d23h59m, default = 5m). Requires quarantine set to attacker."
                },
                "QuarantineLog": {
                    "type": "string",
                    "description": "Enable/disable quarantine logging. Valid values: `disable`, `enable`."
                },
                "RateCount": {
                    "type": "number",
                    "description": "Count of the rate."
                },
                "RateDuration": {
                    "type": "number",
                    "description": "Duration (sec) of the rate."
                },
                "RateMode": {
                    "type": "string",
                    "description": "Rate limit mode. Valid values: `periodical`, `continuous`."
                },
                "RateTrack": {
                    "type": "string",
                    "description": "Track the packet protocol field. Valid values: `none`, `src-ip`, `dest-ip`, `dhcp-client-mac`, `dns-domain`."
                },
                "Severity": {
                    "type": "string",
                    "description": "Relative severity of the signature, from info to critical. Log messages generated by the signature include the severity."
                },
                "Status": {
                    "type": "string",
                    "description": "Status of the signatures included in filter. default enables the filter and only use filters with default status of enable. Filters with default status of disable will not be used. Valid values: `disable`, `enable`, `default`."
                },
                "Cve": {
                    "type": "array",
                    "insertionOrder": true,
                    "items": {
                        "$ref": "#/definitions/CveDefinition"
                    }
                },
                "ExemptIp": {
                    "type": "array",
                    "insertionOrder": true,
                    "items": {
                        "$ref": "#/definitions/ExemptIpDefinition"
                    }
                },
                "Rule": {
                    "type": "array",
                    "insertionOrder": true,
                    "items": {
                        "$ref": "#/definitions/RuleDefinition"
                    }
                }
            },
            "required": []
        },
        "FilterDefinition": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "Action": {
                    "type": "string",
                    "description": "Action of selected rules. Valid values: `pass`, `block`, `reset`, `default`."
                },
                "Application": {
                    "type": "string",
                    "description": "Vulnerable application filter."
                },
                "Location": {
                    "type": "string",
                    "description": "Vulnerability location filter."
                },
                "Log": {
                    "type": "string",
                    "description": "Enable/disable logging of selected rules. Valid values: `disable`, `enable`."
                },
                "LogPacket": {
                    "type": "string",
                    "description": "Enable/disable packet logging of selected rules. Valid values: `disable`, `enable`."
                },
                "Name": {
                    "type": "string",
                    "description": "Filter name."
                },
                "Os": {
                    "type": "string",
                    "description": "Vulnerable OS filter."
                },
                "Protocol": {
                    "type": "string",
                    "description": "Vulnerable protocol filter."
                },
                "Quarantine": {
                    "type": "string",
                    "description": "Quarantine IP or interface. Valid values: `none`, `attacker`."
                },
                "QuarantineExpiry": {
                    "type": "number",
                    "description": "Duration of quarantine in minute."
                },
                "QuarantineLog": {
                    "type": "string",
                    "description": "Enable/disable logging of selected quarantine. Valid values: `disable`, `enable`."
                },
                "Severity": {
                    "type": "string",
                    "description": "Vulnerability severity filter."
                },
                "Status": {
                    "type": "string",
                    "description": "Selected rules status. Valid values: `disable`, `enable`, `default`."
                }
            },
            "required": []
        },
        "OverrideDefinition": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "Action": {
                    "type": "string",
                    "description": "Action of override rule. Valid values: `pass`, `block`, `reset`."
                },
                "Log": {
                    "type": "string",
                    "description": "Enable/disable logging. Valid values: `disable`, `enable`."
                },
                "LogPacket": {
                    "type": "string",
                    "description": "Enable/disable packet logging. Valid values: `disable`, `enable`."
                },
                "Quarantine": {
                    "type": "string",
                    "description": "Quarantine IP or interface. Valid values: `none`, `attacker`."
                },
                "QuarantineExpiry": {
                    "type": "number",
                    "description": "Duration of quarantine in minute."
                },
                "QuarantineLog": {
                    "type": "string",
                    "description": "Enable/disable logging of selected quarantine. Valid values: `disable`, `enable`."
                },
                "RuleId": {
                    "type": "number",
                    "description": "Override rule ID."
                },
                "Status": {
                    "type": "string",
                    "description": "Enable/disable status of override rule. Valid values: `disable`, `enable`."
                },
                "ExemptIp": {
                    "type": "array",
                    "insertionOrder": true,
                    "items": {
                        "$ref": "#/definitions/ExemptIpDefinition"
                    }
                }
            },
            "required": []
        },
        "CveDefinition": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "CveEntry": {
                    "type": "string",
                    "description": "CVE IDs or CVE wildcards."
                }
            },
            "required": []
        },
        "ExemptIpDefinition": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "DstIp": {
                    "type": "string",
                    "description": "Destination IP address and netmask."
                },
                "Id": {
                    "type": "number",
                    "description": "Exempt IP ID."
                },
                "SrcIp": {
                    "type": "string",
                    "description": "Source IP address and netmask."
                }
            },
            "required": []
        },
        "RuleDefinition": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "Id": {
                    "type": "number",
                    "description": "Rule IPS."
                }
            },
            "required": []
        }
    },
    "properties": {
        "tfcfnid": {
            "description": "Internal identifier for tracking resource changes. Do not use.",
            "type": "string"
        },
        "BlockMaliciousUrl": {
            "type": "string",
            "description": "Enable/disable malicious URL blocking. Valid values: `disable`, `enable`."
        },
        "Comment": {
            "type": "string",
            "description": "Comment."
        },
        "DynamicSortSubtable": {
            "type": "string",
            "description": "true or false, set this parameter to true when using dynamic for_each + toset to configure and sort sub-tables, please do not set this parameter when configuring static sub-tables."
        },
        "ExtendedLog": {
            "type": "string",
            "description": "Enable/disable extended logging. Valid values: `enable`, `disable`."
        },
        "Id": {
            "type": "string"
        },
        "Name": {
            "type": "string",
            "description": "Sensor name."
        },
        "ReplacemsgGroup": {
            "type": "string",
            "description": "Replacement message group."
        },
        "ScanBotnetConnections": {
            "type": "string",
            "description": "Block or monitor connections to Botnet servers, or disable Botnet scanning. Valid values: `disable`, `block`, `monitor`."
        },
        "Vdomparam": {
            "type": "string",
            "description": "Specifies the vdom to which the resource will be applied when the FortiGate unit is running in VDOM mode. Only one vdom can be specified. If you want to inherit the vdom configuration of the provider, please do not set this parameter."
        },
        "Entries": {
            "type": "array",
            "insertionOrder": false,
            "items": {
                "$ref": "#/definitions/EntriesDefinition"
            }
        },
        "Filter": {
            "type": "array",
            "insertionOrder": false,
            "items": {
                "$ref": "#/definitions/FilterDefinition"
            }
        },
        "Override": {
            "type": "array",
            "insertionOrder": false,
            "items": {
                "$ref": "#/definitions/OverrideDefinition"
            }
        }
    },
    "additionalProperties": false,
    "required": [
        "Name"
    ],
    "readOnlyProperties": [
        "/properties/tfcfnid",
        "/properties/Id"
    ],
    "primaryIdentifier": [
        "/properties/tfcfnid"
    ],
    "handlers": {
        "create": {
            "permissions": [
                "s3:GetObject",
                "s3:DeleteObject",
                "lambda:InvokeFunction"
            ]
        },
        "read": {
            "permissions": [
                "s3:GetObject"
            ]
        },
        "update": {
            "permissions": [
                "s3:GetObject",
                "s3:DeleteObject",
                "lambda:InvokeFunction"
            ]
        },
        "delete": {
            "permissions": [
                "s3:GetObject",
                "s3:DeleteObject",
                "lambda:InvokeFunction"
            ]
        },
        "list": {
            "permissions": [
                "s3:GetObject",
                "s3:ListBucket"
            ]
        }
    }
}