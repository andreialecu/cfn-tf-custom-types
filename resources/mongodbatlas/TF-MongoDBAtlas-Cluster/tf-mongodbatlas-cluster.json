{
    "typeName": "TF::MongoDBAtlas::Cluster",
    "description": "`mongodbatlas_cluster` provides a Cluster resource. The resource lets you create, edit and delete clusters. The resource requires your Project ID.\n\n-> **NOTE:** Groups and projects are synonymous terms. You may find group_id in the official documentation.\n\n-> **NOTE:** A network container is created for a cluster to reside in if one does not yet exist in the project.  To  use this automatically created container with another resource, such as peering, the `container_id` is exported after creation.\n\n~> **IMPORTANT:**\n<br> &#8226; Free tier cluster creation (M0) is not supported via API or by this Provider.\n<br> &#8226; Shared tier clusters (M2, M5) cannot be upgraded to higher tiers via API or by this Provider.\n<br> &#8226; Changes to cluster configurations can affect costs. Before making changes, please see [Billing](https://docs.atlas.mongodb.com/billing/).   \n<br> &#8226; If your Atlas project contains a custom role that uses actions introduced in a specific MongoDB version, you cannot create a cluster ...",
    "sourceUrl": "https://github.com/iann0036/cfn-tf-custom-types.git",
    "documentationUrl": "https://github.com/iann0036/cfn-tf-custom-types/blob/docs/resources/mongodbatlas/TF-MongoDBAtlas-Cluster/docs/README.md",
    "definitions": {
        "BiConnectorDefinition": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "MapKey": {
                    "type": "string"
                },
                "MapValue": {
                    "type": "string"
                }
            },
            "required": [
                "MapKey",
                "MapValue"
            ]
        },
        "ConnectionStringsDefinition": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "MapKey": {
                    "type": "string"
                },
                "MapValue": {
                    "type": "string"
                }
            },
            "required": [
                "MapKey",
                "MapValue"
            ]
        },
        "ConnectionStringsDefinition2": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "MapKey": {
                    "type": "string"
                },
                "MapValue": {
                    "type": "string"
                }
            },
            "required": [
                "MapKey",
                "MapValue"
            ]
        },
        "ConnectionStringsDefinition3": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "EndpointId": {
                    "type": "string"
                },
                "ProviderName": {
                    "type": "string"
                },
                "Region": {
                    "type": "string"
                }
            }
        },
        "ConnectionStringsDefinition4": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "ConnectionString": {
                    "type": "string"
                },
                "Endpoints": {
                    "type": "array",
                    "insertionOrder": false,
                    "items": {
                        "$ref": "#/definitions/ConnectionStringsDefinition3"
                    }
                },
                "SrvConnectionString": {
                    "type": "string"
                },
                "Type": {
                    "type": "string"
                }
            }
        },
        "ConnectionStringsDefinition5": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "AwsPrivateLink": {
                    "type": "array",
                    "insertionOrder": true,
                    "items": {
                        "$ref": "#/definitions/ConnectionStringsDefinition"
                    }
                },
                "AwsPrivateLinkSrv": {
                    "type": "array",
                    "insertionOrder": true,
                    "items": {
                        "$ref": "#/definitions/ConnectionStringsDefinition2"
                    }
                },
                "Private": {
                    "type": "string"
                },
                "PrivateEndpoint": {
                    "type": "array",
                    "insertionOrder": false,
                    "items": {
                        "$ref": "#/definitions/ConnectionStringsDefinition4"
                    }
                },
                "PrivateSrv": {
                    "type": "string"
                },
                "Standard": {
                    "type": "string"
                },
                "StandardSrv": {
                    "type": "string"
                }
            }
        },
        "SnapshotBackupPolicyDefinition": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "FrequencyInterval": {
                    "type": "number"
                },
                "FrequencyType": {
                    "type": "string"
                },
                "Id": {
                    "type": "string"
                },
                "RetentionUnit": {
                    "type": "string"
                },
                "RetentionValue": {
                    "type": "number"
                }
            }
        },
        "SnapshotBackupPolicyDefinition2": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "Id": {
                    "type": "string"
                },
                "PolicyItem": {
                    "type": "array",
                    "insertionOrder": false,
                    "items": {
                        "$ref": "#/definitions/SnapshotBackupPolicyDefinition"
                    }
                }
            }
        },
        "SnapshotBackupPolicyDefinition3": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "ClusterId": {
                    "type": "string"
                },
                "ClusterName": {
                    "type": "string"
                },
                "NextSnapshot": {
                    "type": "string"
                },
                "Policies": {
                    "type": "array",
                    "insertionOrder": false,
                    "items": {
                        "$ref": "#/definitions/SnapshotBackupPolicyDefinition2"
                    }
                },
                "ReferenceHourOfDay": {
                    "type": "number"
                },
                "ReferenceMinuteOfHour": {
                    "type": "number"
                },
                "RestoreWindowDays": {
                    "type": "number"
                },
                "UpdateSnapshots": {
                    "type": "boolean"
                }
            }
        },
        "AdvancedConfigurationDefinition": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "FailIndexKeyTooLong": {
                    "type": "boolean"
                },
                "JavascriptEnabled": {
                    "type": "boolean"
                },
                "MinimumEnabledTlsProtocol": {
                    "type": "string"
                },
                "NoTableScan": {
                    "type": "boolean"
                },
                "OplogSizeMb": {
                    "type": "number"
                },
                "SampleRefreshIntervalBiConnector": {
                    "type": "number"
                },
                "SampleSizeBiConnector": {
                    "type": "number"
                }
            },
            "required": []
        },
        "BiConnectorConfigDefinition": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "Enabled": {
                    "type": "boolean"
                },
                "ReadPreference": {
                    "type": "string"
                }
            },
            "required": []
        },
        "LabelsDefinition": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "Key": {
                    "type": "string"
                },
                "Value": {
                    "type": "string"
                }
            },
            "required": []
        },
        "ReplicationSpecsDefinition": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "Id": {
                    "type": "string"
                },
                "NumShards": {
                    "type": "number"
                },
                "ZoneName": {
                    "type": "string"
                },
                "RegionsConfig": {
                    "type": "array",
                    "insertionOrder": false,
                    "items": {
                        "$ref": "#/definitions/RegionsConfigDefinition"
                    }
                }
            },
            "required": [
                "NumShards"
            ]
        },
        "RegionsConfigDefinition": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
                "AnalyticsNodes": {
                    "type": "number"
                },
                "ElectableNodes": {
                    "type": "number"
                },
                "Priority": {
                    "type": "number"
                },
                "ReadOnlyNodes": {
                    "type": "number"
                },
                "RegionName": {
                    "type": "string"
                }
            },
            "required": []
        }
    },
    "properties": {
        "tfcfnid": {
            "description": "Internal identifier for tracking resource changes. Do not use.",
            "type": "string"
        },
        "AutoScalingComputeEnabled": {
            "type": "boolean",
            "description": "Specifies whether cluster tier auto-scaling is enabled. The default is false.\n- Set to `true` to enable cluster tier auto-scaling. If enabled, you must specify a value for `providerSettings.autoScaling.compute.maxInstanceSize`.\n- Set to `false` to disable cluster tier auto-scaling."
        },
        "AutoScalingComputeScaleDownEnabled": {
            "type": "boolean",
            "description": "Set to `true` to enable the cluster tier to scale down. This option is only available if `autoScaling.compute.enabled` is `true`.\n- If this option is enabled, you must specify a value for `providerSettings.autoScaling.compute.minInstanceSize`."
        },
        "AutoScalingDiskGbEnabled": {
            "type": "boolean",
            "description": "Specifies whether disk auto-scaling is enabled. The default is true.\n- Set to `true` to enable disk auto-scaling.\n- Set to `false` to disable disk auto-scaling."
        },
        "BackingProviderName": {
            "type": "string",
            "description": "Cloud service provider on which the server for a multi-tenant cluster is provisioned."
        },
        "BackupEnabled": {
            "type": "boolean",
            "description": "Legacy Backup - Set to true to enable Atlas legacy backups for the cluster.\n**Important** - MongoDB deprecated the Legacy Backup feature. Clusters that use Legacy Backup can continue to use it. MongoDB recommends using [Cloud Backups](https://docs.atlas.mongodb.com/backup/cloud-backup/overview/).\n* Any net new Atlas clusters of any type do not support this parameter. These clusters must use Cloud Backup, `provider_backup_enabled`, to enable Cloud Backup.  If you create a new Atlas cluster and set `backup_enabled` to true, the Provider will respond with an error.  This change doesn\u2019t affect existing clusters that use legacy backups.\n* Setting this value to false to disable legacy backups for the cluster will let Atlas delete any stored snapshots. In order to preserve the legacy backups snapshots, disable the legacy backups and enable the cloud backups in the single **terraform apply** action.\n```\nbackup_enabled = \"false\"\nprovider_backup_enabled = \"true\"\n```\n* The default value is false.  M10 and above only."
        },
        "BiConnector": {
            "type": "array",
            "insertionOrder": true,
            "items": {
                "$ref": "#/definitions/BiConnectorDefinition"
            },
            "description": "Specifies BI Connector for Atlas configuration on this cluster. BI Connector for Atlas is only available for M10+ clusters. See [BI Connector](#bi-connector) below for more details. **DEPRECATED** Use `bi_connector_config` instead."
        },
        "ClusterId": {
            "type": "string"
        },
        "ClusterType": {
            "type": "string",
            "description": "Specifies the type of the cluster that you want to modify. You cannot convert a sharded cluster deployment to a replica set deployment."
        },
        "ConnectionStrings": {
            "type": "array",
            "insertionOrder": false,
            "items": {
                "$ref": "#/definitions/ConnectionStringsDefinition5"
            }
        },
        "ContainerId": {
            "type": "string"
        },
        "DiskSizeGb": {
            "type": "number",
            "description": "Capacity, in gigabytes, of the host\u2019s root volume. Increase this number to add capacity, up to a maximum possible value of 4096 (i.e., 4 TB). This value must be a positive integer.\n* The minimum disk size for dedicated clusters is 10GB for AWS and GCP. If you specify diskSizeGB with a lower disk size, Atlas defaults to the minimum disk size value.\n* Note: The maximum value for disk storage cannot exceed 50 times the maximum RAM for the selected cluster. If you require additional storage space beyond this limitation, consider upgrading your cluster to a higher tier.\n* Cannot be used with clusters with local NVMe SSDs\n* Cannot be used with Azure clusters."
        },
        "EncryptionAtRestProvider": {
            "type": "string",
            "description": "Possible values are AWS, GCP, AZURE or NONE.  Only needed if you desire to manage the keys, see [Encryption at Rest using Customer Key Management](https://docs.atlas.mongodb.com/security-aws-kms/) for complete documentation.  You must configure encryption at rest for the Atlas project before enabling it on any cluster in the project. For complete documentation on configuring Encryption at Rest, see Encryption at Rest using Customer Key Management. Requires M10 or greater. and for legacy backups, backup_enabled, to be false or omitted. **Note: Atlas encrypts all cluster storage and snapshot volumes, securing all cluster data on disk: a concept known as encryption at rest, by default**."
        },
        "Id": {
            "type": "string"
        },
        "MongoDbMajorVersion": {
            "type": "string",
            "description": "Version of the cluster to deploy. Atlas supports the following MongoDB versions for M10+ clusters: `3.6`, `4.0`, or `4.2`. You must set this value to `4.2` if `provider_instance_size_name` is either M2 or M5."
        },
        "MongoDbVersion": {
            "type": "string"
        },
        "MongoUri": {
            "type": "string"
        },
        "MongoUriUpdated": {
            "type": "string"
        },
        "MongoUriWithOptions": {
            "type": "string"
        },
        "Name": {
            "type": "string",
            "description": "Name of the cluster as it appears in Atlas. Once the cluster is created, its name cannot be changed."
        },
        "NumShards": {
            "type": "number",
            "description": "Selects whether the cluster is a replica set or a sharded cluster. If you use the replicationSpecs parameter, you must set num_shards."
        },
        "Paused": {
            "type": "boolean"
        },
        "PitEnabled": {
            "type": "boolean",
            "description": "- Flag that indicates if the cluster uses Continuous Cloud Backup. If set to true, provider_backup_enabled must also be set to true."
        },
        "ProjectId": {
            "type": "string",
            "description": "The unique ID for the project to create the database user."
        },
        "ProviderAutoScalingComputeMaxInstanceSize": {
            "type": "string",
            "description": "Maximum instance size to which your cluster can automatically scale (e.g., M40). Required if `autoScaling.compute.enabled` is `true`."
        },
        "ProviderAutoScalingComputeMinInstanceSize": {
            "type": "string",
            "description": "Minimum instance size to which your cluster can automatically scale (e.g., M10). Required if `autoScaling.compute.scaleDownEnabled` is `true`."
        },
        "ProviderBackupEnabled": {
            "type": "boolean",
            "description": "Flag indicating if the cluster uses Cloud Backup for backups."
        },
        "ProviderDiskIops": {
            "type": "number",
            "description": "The maximum input/output operations per second (IOPS) the system can perform. The possible values depend on the selected `provider_instance_size_name` and `disk_size_gb`.  This setting requires that `provider_instance_size_name` to be M30 or greater and cannot be used with clusters with local NVMe SSDs.  The default value for `provider_disk_iops` is the same as the cluster tier's Standard IOPS value, as viewable in the Atlas console.  It is used in cases where a higher number of IOPS is needed and possible.  If a value is submitted that is lower or equal to the default IOPS value for the cluster tier Atlas ignores the requested value and uses the default.  More details available under the providerSettings.diskIOPS parameter: [MongoDB API Clusters](https://docs.atlas.mongodb.com/reference/api/clusters-create-one/)\n* You do not need to configure IOPS for a STANDARD disk configuration but only for a PROVISIONED configuration."
        },
        "ProviderDiskTypeName": {
            "type": "string",
            "description": "Azure disk type of the server\u2019s root volume. If omitted, Atlas uses the default disk type for the selected providerSettings.instanceSizeName.  Example disk types and associated storage sizes: P4 - 32GB, P6 - 64GB, P10 - 128GB, P15 - 256GB, P20 - 512GB, P30 - 1024GB, P40 - 2048GB, P50 - 4095GB.  More information and the most update to date disk types/storage sizes can be located at https://docs.atlas.mongodb.com/reference/api/clusters-create-one/."
        },
        "ProviderEncryptEbsVolume": {
            "type": "boolean",
            "description": "**(Deprecated) The Flag is always true.** Flag that indicates whether the Amazon EBS encryption feature encrypts the host's root volume for both data at rest within the volume and for data moving between the volume and the cluster. Note: This setting is always enabled for clusters with local NVMe SSDs. **Atlas encrypts all cluster storage and snapshot volumes, securing all cluster data on disk: a concept known as encryption at rest, by default.**."
        },
        "ProviderEncryptEbsVolumeFlag": {
            "type": "boolean"
        },
        "ProviderInstanceSizeName": {
            "type": "string",
            "description": "Atlas provides different instance sizes, each with a default storage capacity and RAM size. The instance size you select is used for all the data-bearing servers in your cluster. See [Create a Cluster](https://docs.atlas.mongodb.com/reference/api/clusters-create-one/) `providerSettings.instanceSizeName` for valid values and default resources.\n**Note** free tier (M0) creation is not supported by the Atlas API and hence not supported by this provider.)."
        },
        "ProviderName": {
            "type": "string",
            "description": "Cloud service provider on which the servers are provisioned."
        },
        "ProviderRegionName": {
            "type": "string",
            "description": "Physical location of your MongoDB cluster. The region you choose can affect network latency for clients accessing your databases.  Requires the **Atlas region name**, see the reference list for [AWS](https://docs.atlas.mongodb.com/reference/amazon-aws/), [GCP](https://docs.atlas.mongodb.com/reference/google-gcp/), [Azure](https://docs.atlas.mongodb.com/reference/microsoft-azure/).\nDo not specify this field when creating a multi-region cluster using the replicationSpec document or a Global Cluster with the replicationSpecs array."
        },
        "ProviderVolumeType": {
            "type": "string",
            "description": "The type of the volume. The possible values are: `STANDARD` and `PROVISIONED`.  `PROVISIONED` is ONLY required if setting IOPS higher than the default instance IOPS."
        },
        "ReplicationFactor": {
            "type": "number",
            "description": "Number of replica set members. Each member keeps a copy of your databases, providing high availability and data redundancy. The possible values are 3, 5, or 7. The default value is 3."
        },
        "SnapshotBackupPolicy": {
            "type": "array",
            "insertionOrder": false,
            "items": {
                "$ref": "#/definitions/SnapshotBackupPolicyDefinition3"
            }
        },
        "SrvAddress": {
            "type": "string"
        },
        "StateName": {
            "type": "string"
        },
        "AdvancedConfiguration": {
            "type": "array",
            "insertionOrder": false,
            "items": {
                "$ref": "#/definitions/AdvancedConfigurationDefinition"
            },
            "maxItems": 1
        },
        "BiConnectorConfig": {
            "type": "array",
            "insertionOrder": false,
            "items": {
                "$ref": "#/definitions/BiConnectorConfigDefinition"
            },
            "maxItems": 1
        },
        "Labels": {
            "type": "array",
            "insertionOrder": true,
            "items": {
                "$ref": "#/definitions/LabelsDefinition"
            }
        },
        "ReplicationSpecs": {
            "type": "array",
            "insertionOrder": false,
            "items": {
                "$ref": "#/definitions/ReplicationSpecsDefinition"
            }
        }
    },
    "additionalProperties": false,
    "required": [
        "Name",
        "ProjectId",
        "ProviderInstanceSizeName",
        "ProviderName"
    ],
    "readOnlyProperties": [
        "/properties/tfcfnid",
        "/properties/ClusterId",
        "/properties/ConnectionStrings",
        "/properties/ContainerId",
        "/properties/Id",
        "/properties/MongoDbVersion",
        "/properties/MongoUri",
        "/properties/MongoUriUpdated",
        "/properties/MongoUriWithOptions",
        "/properties/Paused",
        "/properties/ProviderEncryptEbsVolumeFlag",
        "/properties/SnapshotBackupPolicy",
        "/properties/SrvAddress",
        "/properties/StateName"
    ],
    "primaryIdentifier": [
        "/properties/tfcfnid"
    ],
    "handlers": {
        "create": {
            "permissions": [
                "s3:GetObject",
                "s3:DeleteObject",
                "lambda:InvokeFunction"
            ]
        },
        "read": {
            "permissions": [
                "s3:GetObject"
            ]
        },
        "update": {
            "permissions": [
                "s3:GetObject",
                "s3:DeleteObject",
                "lambda:InvokeFunction"
            ]
        },
        "delete": {
            "permissions": [
                "s3:GetObject",
                "s3:DeleteObject",
                "lambda:InvokeFunction"
            ]
        },
        "list": {
            "permissions": [
                "s3:GetObject",
                "s3:ListBucket"
            ]
        }
    }
}